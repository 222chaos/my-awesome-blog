## 问题分析

错误 `object NoneType can't be used in 'await' expression` 的根本原因是：

在 [perf_monitor.py](file:///E:\A_Project\my-awesome-blog\backend\app\utils\perf_monitor.py#L19) 的 `_log_with_semaphore` 函数中，使用了 `await log_func(*args, **kwargs)`，但 `log_performance` 和 `log_api_call` 函数在 [logger.py](file:///E:\A_Project\my-awesome-blog\backend\app\utils\logger.py) 中是**同步函数**，不是异步函数。

当对同步函数使用 `await` 时，Python 返回 `None`，然后尝试 `await None` 就会触发错误。

## 修复方案

修改 [perf_monitor.py](file:///E:\A_Project\my-awesome-blog\backend\app\utils\perf_monitor.py#L19) 的 `_log_with_semaphore` 函数：

```python
async def _log_with_semaphore(log_func, *args, **kwargs):
    """使用信号量包装日志任务，限制并发数"""
    try:
        async with _log_task_semaphore:
            # 检查是否为异步函数
            if asyncio.iscoroutinefunction(log_func):
                await log_func(*args, **kwargs)
            else:
                # 同步函数直接调用，不使用 await
                log_func(*args, **kwargs)
    except Exception as e:
        app_logger.error(f"Failed to log performance metrics: {str(e)}")
```

这样可以同时支持同步和异步日志函数。