# 修复计划：数据库模型与迁移不匹配导致的 500 错误

## 问题
前端相册页面报错 `GET http://localhost:3000/api/albums 500 (Internal Server Error)`，根本原因是数据库迁移文件中的字段类型与模型定义不匹配。

## 具体问题
1. `portfolios` 表：迁移中 `id` 为 `Integer`，模型中为 `UUID`
2. `images` 表：迁移中 `id` 为 `Integer`，模型中为 `UUID`
3. `image_variants` 表：迁移中 `id` 为 `Integer`，模型中为 `UUID`

## 修复步骤

### 步骤 1：创建新的迁移文件
- 创建 Alembic 迁移文件，将受影响表的 `id` 列从 `Integer` 迁移到 `UUID`
- 涉及表：`portfolios`, `images`, `image_variants`

### 步骤 2：修复初始迁移文件
- 更新 `001_add_new_tables.py` 中的表定义
- 将相关表的 `id` 列从 `sa.Integer()` 改为 `sa.UUID()` 或 `sa.String(36)`
- 将 `portfolio_images` 关联表的 `portfolio_id` 和 `image_id` 也改为 UUID 类型

### 步骤 3：重新初始化数据库
- 删除现有数据库或回滚迁移
- 重新运行迁移以创建正确的表结构

### 步骤 4：验证修复
- 重启后端服务器
- 测试 `/api/albums` 端点是否正常工作
- 确认前端相册页面能正常加载

## 预期结果
- 数据库表结构与模型定义完全一致
- 相册 API 正常返回数据
- 前端页面不再报错